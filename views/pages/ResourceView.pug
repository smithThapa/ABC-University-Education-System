extends ../components/_templateBase


block append head
    link(rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css")
    link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css")
    

block append scripts
    script(src='https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js')
    script(src='https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js')
    script(src='/js/databaseDesignJQuerry.js')
    script(src='/js/resource.js')

block content
    +breadcrumbDisplay([['Home','/home'],['Resources']])
    h2 Resources
    .row
        form.col-6(action="/resources/upload" method="post" enctype="multipart/form-data")
            .input-group
                //- .form-row.mb-1
                .custom-file
                    //- .col-9.mr-4
                    input.custom-file-input#file(type="file" name="file" required)
                    label#file-label(for="file" class="custom-file-label" aria-describedby='custom-file-label-append-upload') Choose File...
                input.btn.btn-primary.input-group-text#custom-file-label-append-upload( type= "submit" value="Upload")    


    if files
    
        table.table#dataResources.table.table-borderless.table-sm
            thead
                tr
                    th.text-right.px-5 Sort By Date
            tbody
                each file in files
                
                    //-delete models of each user
                    if user.id == file.user.id
                        +deleteModalFileTemplate(file._id, file.filename, 'resources')
                    
                    tr
                        td
                            -const uploadTime = moment(file.uploadDate)
                            p.d-none #{uploadTime}
                            .card
                                .h5.card-header.bg-info.text-white= file.filename
                                .card-body
                                    //- .h6.card-title= ""
                                    if file.isImage
                                        img(src=`/resources/image/${file.filename}`, width="250", alt="", class="img-responsive")
                                    .card-subtitle.my-2
                                    
                                        -const author = file.user.firstName ? `${file.user.firstName} ${file.user.lastName}` : 'ABC University'
                                        
                                        small.text-muted= `Uploaded by: ${author}`
                                        br
                                        -const updateDate = moment(file.uploadDate).format('dddd DD MMM YYYY HH:mm')
                                        small.text-muted= `Upload date: ${updateDate}`
                                .card-footer
                                    a.btn.btn-primary( href= `/resources/files/${file.filename}` target="_blank") Download
                                    hr
                                    //- if userFilesIds.includes(file._id.toString())
                                    -if (user._id == file.user.id)
                                        a.btn.btn-danger.text-white(type='button' data-toggle="modal" data-target=`#deleteModalFile${file._id}`) Delete

    else
        |No files to show 



