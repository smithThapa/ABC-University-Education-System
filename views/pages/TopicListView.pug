extends ../components/_templateBase

block append head
    link(rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css")
    link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css")
    

block append scripts
    script(src='https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js')
    script(src='https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js')
    script(src='/js/databaseDesignJQuerry.js')
    script(src='/js/tooltip.js')
           
block content
    +breadcrumbDisplay([['Home','/home'],['Manage Forums','/manage_forums'],['Manage Topics']])
    
    //- -const creationDate = forum.createdAt.format();
    -const creationDate = moment(forum.createdAt).format('dddd DD MMM YYYY HH:mm'); 
    -const authorForum = forum.user.firstName ? `${forum.user.firstName} ${forum.user.lastName}` : 'ABC University'
        
    a.text-decoration-none.h2(href='/manage_forums') Forum: #{forum.title} - #{forum.type}
    small.text-muted.mt-0= `Author: ${authorForum}. Created on: ${creationDate}`
    p #{forum.description}
    
    .d-flex.mt-0
        h2 Manage Topics
        a.btn.btn-primary.text-white.mb-auto.ml-auto(href =`/manage_forums/${forum.slug}/manage_topics/new_topic`) + Create Topic
        
    -if(topics.length<1)
        h4.font-weight-bold.text-dark.mt-0.ml-4 No topics in this forum to manage.
    - else
        table#dataTable.table.table-striped.table-bordered.table-sm.text-center
            thead
                tr
                    //- th #
                    th Title
                    th Author
                    th Creation date
                    th # Comments
                    th Comments
                    th Edit
                    th Delete
            
            tbody
                each topic in topics
                    //- modal to delete element
                    +deleteModalTemplate(topic.id, title, topic.title)
                    //- -const creationDate = forum.createdAt.format();
                    -const creationDate = moment(topic.createdAt).format('DD/MMM/YYYY HH:mm');
                    
                        tr
                            //- th= index+1
                            td
                                a.btn(type='button' data-toggle="tooltip" data-html="true" data-placement="bottom" title=`<u>Description</u>: ${topic.description.substring(0,150)}...`) #{topic.title}
                            if topic.user.firstName
                                td= `${topic.user.firstName} ${topic.user.lastName}`
                            else
                                td ABC University
                            td= creationDate
                            td= topic.comments.length
                            td
                                a.btn.btn-info(href=`/manage_forums/${forum.slug}/manage_topics/${topic.slug}/manage_comments`) Open
                                //- a.btn.btn-info(href=`/manageForums/${forum.slug}/manageTopics`) Open
                            td
                                a.btn.btn-success.text-white(href=`/manage_forums/${forum.slug}/manage_topics/${topic.slug}/edit_topic`) Edit
                            td
                                a.btn.btn-danger.text-white(type='button' data-toggle="modal" data-target=`#deleteModal${topic.id}`) Delete
            tfoot
                tr
                    //- th #
                    th Title
                    th Author
                    th Creation date
                    th # Comments
                    th Comments
                    th Edit
                    th Delete