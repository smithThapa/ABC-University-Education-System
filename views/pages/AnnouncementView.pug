extends ../components/_templateBase

block append head
    link(rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css")
    link(rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css")


block append scripts
    script(src='https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js')
    script(src='https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js')
    script(src='/js/databaseDesignJQuerry.js')
    script(src='/js/collapse.js')


block content
    +breadcrumbDisplay([['Home','/home'],['Announcements','/announcements']])

    h2.mt-0 Announcements

    -if(announcements.length<1)
        h4.font-weight-bold.text-dark.mt-0.ml-4 No announcements in this forum.

    -else     
        table.table#dataTableAnnouncements.table.table-borderless.table-sm
            thead
                tr
                    th
                    //- th.text-right.px-5 Sort By Title
            tbody 
                -const numberOfPages = parseInt((records/10)+1)
                -let currentPage = 0
                -let countDown = 0
                -let i = 0

                while currentPage < numberOfPages
                    tr
                        td
                            #accordion

                                -for(;i<countDown+10;i++)

                                    -if( i > records-1) break

                                    -const announcementDate = moment(announcements[i].createdAt).format('dddd DD MMM YYYY HH:mm');
                                    -const announcementDateHeader = moment(announcements[i].createdAt).format("DD MMM").toUpperCase()
                                    .card
                                        .card-header.bg-info.text-white(id=`heading${i}`)                               
                                            h5.mb-0
                                                button.btn.text-white.d-flex(data-toggle='collapse' data-target=`#collapse${i}` aria-expanded='false' aria-controls=`collapse${i}`)
                                                    |#{announcementDateHeader} - #{announcements[i].title}

                                        .collapse(id=`collapse${i}` aria-labelledby=`heading${i}` data-parent='#accordion')
                                            .card-body
                                                .card-subtitle.mb-2
                                                    if (announcements[i].user.firstName)
                                                        small.text-muted= `${announcements[i].user.firstName} ${announcements[i].user.lastName} | Created At:  ${announcementDate}`
                                                    else
                                                        small.text-muted= `ABC University | Created At:  ${announcementDate}`
                                                |#{announcements[i].description}
                                -countDown += 10
                    -currentPage++
